"use strict";var woostifySearchDelay=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(t,s){clearTimeout(e),e=setTimeout(t,s)}}(),woostifyMultiSelect=function(){var e=document.querySelectorAll(".woostify-multi-selection");e.length&&e.forEach(function(e){var t=e.querySelector(".woostify-multi-select-value"),s=e.querySelector(".woostify-multi-select-selection"),o=s.querySelector(".woostify-multi-selection-inner"),i=s.querySelector(".woostify-multi-select-search"),a=e.querySelector(".woostify-multi-select-dropdown"),n=function(e){var s=o.querySelectorAll(".woostify-multi-select-id");if(!s.length){t.value="default";return}var i=[];if(s.forEach(function(e){var t=e.getAttribute("data-id");!(!t||i.includes(t))&&i.push(t)}),!0===e)return i;t.value=i.join("|")},c=function(){var t=o.querySelectorAll(".woostify-multi-select-id");t.length&&t.forEach(function(t){var s=t.getAttribute("data-id"),o=t.querySelector(".woostify-multi-remove-id");o&&(o.onclick=function(){if(t.parentNode){e.classList.add("active");var o=a.querySelector('[data-id="'+s+'"]');o&&o.classList.remove("disabled"),t.remove(),n()}})})};c();var r=function(){var e=a.querySelectorAll(".woostify-multi-select-id");if(e.length)for(var t=0,s=e.length;t<s;t++)e[t].onclick=function(){var e=this.classList.contains("disabled"),t=this.getAttribute("data-id");if(!e){this.classList.add("disabled");var s='<span class="woostify-multi-select-id" data-id="'+t+'">'+this.innerHTML+'<i class="woostify-multi-remove-id dashicons dashicons-no-alt"></i></span>';o.insertAdjacentHTML("afterbegin",s),n(),c()}}};i&&(i.addEventListener("input",function(){var e=this.getAttribute("data-nonce"),t=this.value.trim(),s=this.name,o=this.getAttribute("data-search"),i=new Request(ajaxurl,{method:"POST",body:"action="+s+"&security_nonce="+e+"&keyword="+t,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});if("immediate"===o)r();else{if(t.length<1){a.innerHTML="";return}woostifySearchDelay(function(){fetch(i).then(function(e){if(200!==e.status){console.log("Status Code: "+e.status);return}e.json().then(function(e){if(e.success){var t=new DOMParser().parseFromString(e.data,"text/html"),s=t.querySelectorAll(".woostify-multi-select-id");s.length&&s.forEach(function(e){var t=e.getAttribute("data-id")||"",s=n(!0)||[];s.length&&(s.includes(t)?e.classList.add("disabled"):e.classList.remove("disabled"))}),a.innerHTML=t.body.innerHTML,r()}})}).catch(function(e){a.innerHTML="",console.log(e)})},500)}}),i.addEventListener("focus",function(t){e.classList.add("active"),c(),"immediate"===this.getAttribute("data-search")&&r()})),document.addEventListener("click",function(t){var o=t.target,i=o.closest(".woostify-multi-selection"),a=o.classList.contains("woostify-multi-remove-id"),n=o.classList.contains("woostify-multi-select-id"),c=o.classList.contains("woostify-multi-select-search");if(i!=e){e.classList.remove("active");return}s!==o&&!a&&!n&&!c&&e.classList.remove("active")})})},prevSiblings=function(e){for(var t=[],s=e;s=s.previousElementSibling;)t.push(s);return t},nextSiblings=function(e){for(var t=[],s=e;s=s.nextElementSibling;)t.push(s);return t},siblings=function(e){var t=prevSiblings(e)||[],s=nextSiblings(e)||[];return t.concat(s)},woostifyMultiDependency=function(){var e=document.querySelectorAll(".woostify-multi-dependency");e.length&&e.forEach(function(e){var t=e.querySelectorAll(".woostify-multi-dependency-item [name]");t.length&&t.forEach(function(t,s){var o=t.closest(".woostify-multi-dependency-item");o.getAttribute("data-dependency")&&t.addEventListener("change",function(){var i=t.value,a=parseInt(s)+1,n=e.querySelectorAll(".woostify-multi-dependency-item:nth-child("+a+') ~ .woostify-multi-dependency-item[data-required="'+i+'"]'),c=siblings(o);c.length&&c.forEach(function(e){e.getAttribute("data-required")&&e.classList.remove("active")}),n.length&&n.forEach(function(e){var s=e.getAttribute("data-required"),o=(e.getAttribute("data-value"),new Event("change"));e.querySelector("[name]").dispatchEvent(o),"checkbox"==t.type?t.checked?e.classList.add("active"):e.classList.remove("active"):i==s?e.classList.add("active"):e.classList.remove("active")})})})})},woostifyUpdateValue=function(){var e=document.querySelector(".woostify-featured-setting");if(e){var t=e.querySelectorAll('[type="checkbox"]');t.length&&t.forEach(function(e){e.onchange=function(){e.value=1==e.value?0:1}})}},woostifyDependency=function(){var e=document.querySelectorAll(".woostify-filter-value");e.length&&e.forEach(function(e){e.addEventListener("change",function(){var t=nextSiblings(e.closest(".woostify-filter-item"));t.length&&e.value.trim()&&t.forEach(function(t){var s=t.getAttribute("data-type");s&&("checkbox"===e.type?e.checked&&s==e.value?t.classList.remove("hidden"):t.classList.add("hidden"):s.includes(e.value)?t.classList.remove("hidden"):t.classList.add("hidden"))})})})},woostifyTabSettings=function(){var e=document.querySelector(".woostify-settings-section-tab");if(e){var t=e.querySelectorAll(".tab-head-button");t.length&&(t.forEach(function(t){t.onclick=function(){var s=t.hash?t.hash.substr(1):"",o=siblings(t),i=e.querySelector('.woostify-setting-tab-content[data-tab="'+s+'"]'),a=siblings(i);t.classList.add("active"),o.length&&o.forEach(function(e){e.classList.remove("active")}),i.classList.add("active"),a.length&&a.forEach(function(e){e.classList.remove("active")})}}),window.addEventListener("load",function(){var t=e.querySelector('a[href="'+window.location.hash+'"]'),s=e.querySelector('a[href="#general"]');t?t.click():s&&s.click()}))}},woostifySaveOptions=function(){var e=document.querySelector(".woostify-featured-setting");if(e){var t=e.getAttribute("data-id")||"",s=e.getAttribute("data-nonce")||"",o=e.querySelector(".woostify-save-message"),i=e.querySelectorAll(".save-options");i.length&&t&&s&&i.forEach(function(i){i.onclick=function(){if(!(i.getAttribute("disabled")||e.classList.contains("loading"))){var a=this,n=t.replace(/-/g,"_"),c=e.querySelectorAll("[name*=woostify_"+n+"]"),r={},l=e.querySelectorAll('[required="required"]'),d=!1;if(e.classList.contains("woostify-ajax-search-product-setting")){var u=e.querySelector(".must-choose-one-option"),f=!!u&&u.querySelector('[type="checkbox"]');if(!(u?u.querySelectorAll('[type="checkbox"]:checked'):[]).length&&f){f.focus();return}}if(l.length&&l.forEach(function(t){var s=t.value.trim(),o=t.closest(".woostify-setting-tab-content"),i=t.closest(".woostify-filter-item.hidden"),a=o?o.getAttribute("data-tab"):"";if(!i&&!s){var n=e.querySelector('a[href="#'+a+'"]');n&&!n.classList.contains("active")&&n.click(),d=!0,t.focus();return}}),!d){e.classList.add("loading"),a.setAttribute("disabled","disabled"),a.innerHTML=woostify_edit_screen.saving+"...",c.length&&c.forEach(function(e,t){(e.value.trim()||e.classList.contains("woostify-admin-color-picker")||e.classList.contains("field-empty"))&&(e.name.includes("[]")?r[e.name+"["+t+"]"]=e.value:r[e.name]=e.value)});var y=new Request(ajaxurl,{method:"POST",body:"action=woostify_save_"+n+"_options&security_nonce="+s+"&setting_id="+t+"&options="+JSON.stringify(r),credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(y).then(function(t){if(200!==t.status){console.log("Status Code: "+t.status);return}o?(o.classList.add("success"),o.querySelector(".message-success").innerHTML=woostify_edit_screen.saved_success,setTimeout(function(){o.classList.remove("success")},3e3)):e.querySelector(".woostify-settings-section-footer .info-seuccess")||i.insertAdjacentHTML("afterend",'<span class="info-seuccess">'+woostify_edit_screen.saved_success+"</span>"),e.classList.remove("loading")}).catch(function(){e.classList.remove("loading")}).finally(function(){a.innerHTML=woostify_edit_screen.saved,setTimeout(function(){a.innerHTML=woostify_edit_screen.save,a.removeAttribute("disabled")},1e3)})}}}})}},woostifySaveOptionMessageClose=function(){var e=document.querySelector(".woostify-save-message-close");e&&e.addEventListener("click",function(e){this.closest(".woostify-save-message").classList.remove("success")})},woostifySaleNotificationRemoveMessage=function(){var e=document.querySelector(".woostify-sale-notification-box-message");if(e){var t=e.querySelectorAll(".woostify-sale-notification-remove-message");t.length&&(t.forEach(function(t){t.onclick=function(){if("disabled"!==(this.getAttribute("disabled")||"")&&(this.parentNode.remove(),e.querySelectorAll(".woostify-sale-notification-remove-message").length<=1)){var t=new Event("lastMessage");document.documentElement.dispatchEvent(t)}}}),document.documentElement.addEventListener("lastMessage",function(){var t=e.querySelector(".woostify-sale-notification-remove-message");t&&t.setAttribute("disabled","disabled")}))}},woostifySaleNotificationAddNewMessage=function(){var e=document.querySelector(".woostify-featured-setting"),t=!!e&&document.querySelector(".woostify-sale-notification-box-message"),s=t?t.querySelector(".woostify-sale-notification-message-inner"):"",o=s?s.querySelector(".woostify-sale-notification-remove-message").innerHTML:"",i='<div class="woostify-sale-notification-message-inner">';if(i+='<textarea name="woostify_sale_notification_message[]" required="required"></textarea>',i+='<span class="woostify-sale-notification-remove-message button">'+o+"</span>",i+="</div>",e&&t&&s){var a=e.querySelector(".woostify-sale-notification-add-message");a&&(a.onclick=function(){t.insertAdjacentHTML("beforeend",i),woostifySaleNotificationRemoveMessage();var e=t.querySelector(".woostify-sale-notification-message-inner:last-of-type"),s=!!e&&e.querySelector("textarea");s&&s.focus();var o=t.querySelector('.woostify-sale-notification-remove-message[disabled="disabled"]');o&&o.removeAttribute("disabled")})}},woostifyHeaderFooterBuilderSelectTemplate=function(){var e=document.getElementById("woostify-header-footer-builder-template");e&&e.addEventListener("change",function(){var e=this.value;if("default"===e)this.closest(".input-wrapper").nextElementSibling.remove();else{var t=nextSiblings(this.closest(".input-wrapper")),s=document.getElementById("woostify-hfb-nonce").value;if(0===t.length){var o=new Request(ajaxurl,{method:"POST",body:"action=woostify_pro_select_template&_ajax_nonce="+s+"&template="+e,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(o).then(function(e){if(200!==e.status){console.log("Status Code: "+e.status);return}e.json().then(function(e){if(e.success&&""!==e.data){var t=new DOMParser().parseFromString(e.data,"text/html").querySelector(".input-wrapper");document.querySelector(".woostify-pro-hfb-options-wrapper").append(t)}})})}var i=document.querySelector(".condition-group.sticky");null!==i&&("header"===e?i.classList.contains("hidden")&&i.classList.remove("hidden"):i.classList.contains("hidden")||i.classList.add("hidden"))}})},woostifyChangeDisplayOption=function(){if(document.getElementById("woostify-hfb-nonce")){var e=document.getElementById("woostify-hfb-nonce").value;document.addEventListener("change",function(t){var s=t.target,o=s.getAttribute("id");if("woostify-header-footer-builder-display-on"===o||"woostify-header-footer-builder-no-display-on"===o){var i=s.options[s.selectedIndex].value,a="display_on";"woostify-header-footer-builder-no-display-on"===o&&(a="no_display_on");var n=new Request(ajaxurl,{method:"POST",body:"action=woostify_pro_load_autocomplete&_ajax_nonce="+e+"&post_type="+i+"&type="+a,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(n).then(function(e){if(200!==e.status){console.log("Status Code: "+e.status);return}e.json().then(function(e){e.success&&(s.closest(".condition-group").getElementsByClassName("child-item")[0].innerHTML=e.data)})})}}),document.addEventListener("click",function(e){var t=e.target||e.currentTarget;if(t.getAttribute("class"),t.classList.contains("woostify-select-all-post")||t.classList.contains("woostify-arrow")||t.classList.contains("woostify-select-all")){for(var s,o=t.closest(".woostify-section-select-post"),i=o.children.length,a=0;a<i;a++)if(o.children[a].classList.contains("woostify-section-render--post")){s=o.children[a];break}s.classList.contains("hidden")?(s.classList.remove("hidden"),o.classList.remove("select-all"),o.classList.add("render--post"),o.getElementsByClassName("woostify--hf-post-name")[0].focus()):(s.classList.add("hidden"),o.classList.remove("render--post"),o.classList.add("select-all"))}if(t.classList.contains("woostify-auto-complete-field")&&t.querySelector(".woostify--hf-post-name").focus(),t.classList.contains("post-item")&&!t.classList.contains("disabled")){var n=t.closest(".input-item-wrapper"),c=n.querySelector(".woostify-post-ids").value,r=n.querySelector(".woostify-select-all-post"),l=n.querySelector(".woostify-section-select-post");r.classList.contains("hidden")||r.classList.add("hidden"),c=c&&"all"!==c?c.split(","):[],l.classList.contains("has-option")||l.classList.add("has-option");var d=t.getAttribute("data-item"),u=t.textContent;if(!c.includes(d)){c.push(d);var f=document.createElement("span");f.classList.add("woostify-auto-complete-key"),f.innerHTML='<span class="woostify-title">'+u+'</span><span class="btn-woostify-auto-complete-delete ion-close" data-item="'+d+'"></span>',n.querySelector(".woostify-auto-complete-field").insertBefore(f,n.querySelector(".woostify--hf-post-name"))}n.querySelector(".woostify-post-ids").value=c,n.querySelector(".woostify--hf-post-name").value="",t.classList.add("disabled")}if(t.classList.contains("btn-woostify-auto-complete-delete")){var d=t.getAttribute("data-item"),n=t.closest(".input-item-wrapper"),c=n.querySelector(".woostify-post-ids").value,s=n.querySelector(".woostify-section-render--post"),y=n.querySelector(".woostify-select-all-post"),o=n.querySelector(".woostify-section-select-post");n.closest(".condition-group"),(""===(c=c&&"all"!==c?(c=c.replace(","+d,"")).replace(d,""):[])||null==c)&&(c="all",s.classList.add("hidden"),o.classList.remove("render--post"),o.classList.add("select-all"),o.classList.remove("has-option"),y.classList.remove("hidden"),n.querySelector(".woostify-data").innerHTML=""),n.querySelector(".woostify-post-ids").value=c,t.parentElement.remove()}if("woostify-header-template-sticky"===t.getAttribute("name")){var v=document.querySelector('input[name="woostify-header-template-sticky"]').checked,h=t.closest(".condition-group").querySelector(".child-item");v?h.classList.contains("hidden")&&h.classList.remove("hidden"):h.classList.contains("hidden")||h.classList.add("hidden")}if(document.querySelectorAll(".woostify--hf-post-name").length>0)for(var m=document.querySelectorAll(".woostify--hf-post-name"),p=m.length,w=0;w<p;w++)m[w].value="";if(document.querySelectorAll(".woostify-data").length>0)for(var g=document.querySelectorAll(".woostify-data"),S=g.length,L=0;L<S;L++)g[L].innerHTML=""}),document.addEventListener("keyup",function(t){var s=t.target;if(s.classList.contains("woostify--hf-post-name")){var o=s.closest(".input-item-wrapper"),i=o.querySelector(".woostify-post-type").value,a=o.querySelector(".woostify-post-ids").value,n=s.value,c=new Request(ajaxurl,{method:"POST",body:"action=woostify_pro_load_post&_ajax_nonce="+e+"&post_type="+i+"&key="+n+"&selected="+a,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(c).then(function(e){if(200!==e.status){console.log("Status Code: "+e.status);return}e.json().then(function(e){e.success&&(o.getElementsByClassName("woostify-data")[0].innerHTML=e.data)})})}})}};document.addEventListener("DOMContentLoaded",function(){"function"==typeof woostifyMoveWordpressUpdateVersionNotice&&woostifyMoveWordpressUpdateVersionNotice(),woostifyMultiSelect(),woostifyDependency(),woostifyMultiDependency(),woostifyUpdateValue(),woostifyTabSettings(),woostifySaveOptions(),woostifySaveOptionMessageClose(),woostifySaleNotificationAddNewMessage(),woostifySaleNotificationRemoveMessage(),woostifyHeaderFooterBuilderSelectTemplate(),woostifyChangeDisplayOption()});