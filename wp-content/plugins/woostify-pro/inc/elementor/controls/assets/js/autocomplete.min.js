"use strict";const woostifyAutocompleteSearchDelay=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(t,o){clearTimeout(e),e=setTimeout(t,o)}}(),woostifyAutocompleteRender=function(e="post_type",t="product",o){let n=o.el.querySelector(".wty-autocomplete");if(!n||!o.getControlValue().length)return;let l=o.el.querySelector(".elementor-control-title"),c=n.querySelector(".wty-autocomplete-selection"),i={action:c.querySelector(".wty-autocomplete-selected").name,security_nonce:woostify_autocomplete.nonce,selected_id:o.getControlValue(),query:e,value:t};l&&l.insertAdjacentHTML("beforeend",'<i class="eicon-spinner eicon-animation-spin"></i>'),i=new URLSearchParams(i).toString();let a=new Request(ajaxurl,{method:"POST",body:i,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(a).then((function(n){200===n.status?n.json().then((function(n){n.success&&n.data&&(c.insertAdjacentHTML("afterbegin",n.data),woostifyAutocomplete(e,t,o))})):console.log("Status Code: "+n.status)})).catch((function(e){console.log(e)})).finally((function(){if(l){let e=l.querySelector(".eicon-spinner");e&&e.remove()}}))},woostifyAutocomplete=function(e="post_type",t="product",o){let n=o.el.querySelector(".wty-autocomplete");if(!n)return;let l=n.querySelector(".wty-autocomplete-selection"),c=l.querySelector(".wty-autocomplete-search"),i=n.querySelector(".wty-autocomplete-dropdown");const a=function(e=!1){let t=l.querySelectorAll(".wty-autocomplete-id"),n=[];if(t.forEach((function(e){let t=Number(e.getAttribute("data-id"));t&&!n.includes(t)&&n.push(t)})),!0===e)return n;o.setValue(n)},r=function(){let e=l.querySelectorAll(".wty-autocomplete-id");e.length&&e.forEach((function(e){let t=e.getAttribute("data-id"),o=e.querySelector(".wty-autocomplete-remove-id");o&&(o.onclick=function(){if(!e.parentNode)return;n.classList.add("active");let o=i.querySelector('[data-id="'+t+'"]');o&&o.classList.remove("disabled"),e.remove(),a()})}))};r();c&&c.addEventListener("input",(function(){let o=c.value.trim(),n={action:c.name,security_nonce:woostify_autocomplete.nonce,keyword:o,query:e,value:t};n=new URLSearchParams(n).toString();let s=new Request(ajaxurl,{method:"POST",body:n,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});o.length<1?i.innerHTML="":(i.innerHTML='<span class="wty-autocomplete-searching">'+woostify_autocomplete.searching+"</span>",woostifyAutocompleteSearchDelay((function(){fetch(s).then((function(e){200===e.status?e.json().then((function(e){if(!e.success)return;let t=(new DOMParser).parseFromString(e.data,"text/html"),o=t.querySelectorAll(".wty-autocomplete-id");o.length&&o.forEach((function(e){let t=Number(e.getAttribute("data-id"))||"",o=a(!0)||[];o.length&&(o.includes(t)?e.classList.add("disabled"):e.classList.remove("disabled"))})),i.innerHTML=t.body.innerHTML,function(){let e=i.querySelectorAll(".wty-autocomplete-id");if(e.length)for(let t=0,o=e.length;t<o;t++)e[t].onclick=function(){let e=this,t=e.classList.contains("disabled"),o=e.getAttribute("data-id");if(t)return;i.innerHTML="",c.value="",e.classList.add("disabled");let n='<span class="wty-autocomplete-id" data-id="'+o+'">'+e.innerHTML+'<i class="wty-autocomplete-remove-id eicon-close-circle"></i></span>';l.insertAdjacentHTML("afterbegin",n),a(),r()}}()})):console.log("Status Code: "+e.status)})).catch((function(e){i.innerHTML="",console.log(e)}))}),500))}))},woostifyAutocompleteData={onReady:function(){let e=this,t=e.model.get("query"),o=t.type,n=t.name;woostifyAutocompleteRender(o,n,e),woostifyAutocomplete(o,n,e)}},woostifyAutocompleteControl=elementor.modules.controls.BaseData.extend(woostifyAutocompleteData);elementor.addControlView("autocomplete",woostifyAutocompleteControl);